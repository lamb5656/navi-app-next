<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SwitchVoiceNavi — ブラウザで動く音声ナビ</title>
  <meta name="description" content="MapLibre × OpenRouteService。音声案内、リルート、HUD、PWA対応のブラウザナビ。" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="manifest" href="./manifest.json" />

  <!-- Vendor -->
  <link href="./vendor/maplibre-gl.css" rel="stylesheet" />
  <script src="./vendor/maplibre-gl.js"></script>

  <!-- App styles -->
  <link href="./styles.css" rel="stylesheet" />
</head>
<body>
  <!-- Header -->
  <header class="header">
    <button id="menu-btn" class="btn icon-btn" title="メニュー" aria-label="メニューを開く">☰</button>
    <div class="brand">SwitchVoiceNavi</div>
    <div class="grow">
      <input id="search" class="input" type="search" placeholder="目的地を検索（例：名古屋駅）" autocomplete="off" />
      <button id="btnSearch" class="btn" title="検索" aria-label="検索">検索</button>
      <button id="fav-toggle" class="btn icon-btn star" title="お気に入りに追加/削除" aria-pressed="false">★</button>
      <button id="btnStart" class="btn" title="ナビ開始">開始</button>
      <button id="btnStop" class="btn" title="ナビ終了">終了</button>
      <button id="btnSettings" class="btn" title="設定">設定</button>
    </div>
  </header>

  <!-- Drawer -->
  <div id="drawer-backdrop" class="drawer-backdrop" hidden></div>
  <aside id="drawer" class="drawer" aria-hidden="true" aria-label="メニュー">
    <div class="drawer-header">
      <strong>メニュー</strong>
      <button id="drawer-close" class="btn icon-btn" title="閉じる" aria-label="閉じる">×</button>
    </div>
    <div class="drawer-content">
      <section>
        <h4 style="margin:0 0 6px;">検索履歴</h4>
        <div id="history-list" class="list"></div>
        <div style="display:flex;gap:8px;">
          <button id="btnHistoryClear" class="btn">履歴消去</button>
        </div>
      </section>
      <section>
        <h4 style="margin:8px 0 6px;">お気に入り</h4>
        <div id="favorites-list" class="list"></div>
        <p class="muted">★ボタンで現在の目的地をお気に入りに登録できるにゃ</p>
      </section>
    </div>
  </aside>

  <!-- Map -->
  <div class="map-wrap"><div id="map" aria-label="地図"></div></div>

  <!-- HUD / TBT -->
  <section class="hud" aria-live="off">
    <div class="card">
      <div class="tbt">
        <div id="hud-maneuver" class="tbt-main">準備中…</div>
      </div>
      <div class="tbt-sub" id="hud-next">次の案内 —</div>
    </div>

    <div class="card grid">
      <div class="cell">
        <div class="v" id="hud-distance-km">–</div>
        <div class="k">残距離 (km)</div>
      </div>
      <div class="cell">
        <div class="v" id="hud-eta">–:–</div>
        <div class="k">到着予想</div>
      </div>
      <div class="cell">
        <div class="v" id="hud-status">待機中</div>
        <div class="k">ステータス</div>
      </div>
    </div>
  </section>

  <!-- SR live region -->
  <div id="aria-live" class="sr-live" aria-live="polite" aria-atomic="true"></div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Settings -->
  <div class="settings" id="settings">
    <div class="panel">
      <h3 style="margin:0;font-size:16px;">設定</h3>
      <div class="row">
        <label for="sel-voice">音声</label>
        <select id="sel-voice"></select>
      </div>
      <div class="row">
        <label for="chk-avoid-toll">有料道路回避</label>
        <input id="chk-avoid-toll" type="checkbox" />
      </div>
      <div class="row">
        <label for="sel-theme">テーマ</label>
        <select id="sel-theme">
          <option value="system">システム</option>
          <option value="light">ライト</option>
          <option value="dark">ダーク</option>
        </select>
      </div>
      <div class="row" style="justify-content:flex-end;">
        <button id="btnSettingsClose" class="btn">閉じる</button>
      </div>
    </div>
  </div>

  <!-- App scripts (順序重要) -->
  <script type="module" src="./js/map.js"></script>
  <script type="module" src="./js/nav.js"></script>
  <script type="module" src="./js/ui/hud.js"></script>

  <script type="module" src="./js/ui/search.js"></script>
  <script type="module" src="./js/ui/favorites.js"></script>
  <script type="module" src="./js/ui/history.js"></script>

  <!-- 最小UI制御（フォールバック） -->
  <script type="module" src="./js/ui/shell.js"></script>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
